@using PagedList;

@using PagedList.Mvc;

@model IPagedList<FlightJobs.Models.JobListModel>



@{
    ViewBag.Title = "Result";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<p>
    <h3>Select one or more jobs to update your pending list.</h3>
</p>
<hr />
<p style="color:red">
@Html.ValidationMessage("error")
</p>

@using (Html.BeginForm("ResultNext", "SearchJobs", FormMethod.Post))
{
    if (Model.Count() > 0)
    {
        <div class="panel panel-default text-center">
            <p><b>@Html.DisplayFor(modelItem => Model.FirstOrDefault().Departure.ICAO)</b> @Html.DisplayFor(modelItem => Model.FirstOrDefault().Departure.Name) - 
            @Html.DisplayFor(modelItem => Model.FirstOrDefault().Departure.City)</p>
            <table class="table table-striped table-bordered table-hover" style="font-size: 10px;">
                <tr>
                    <th>
                        @Html.DisplayNameFor(model => model.First().Selected)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.First().Arrival)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.First().Dist) (nm)
                    </th>
                    <th>
                        Payload
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.First().Pay)
                    </th>
                </tr>

                @foreach (var item in Model)
                {
                    <tr>
                        <td>
                            @Html.CheckBoxFor(modelItem => item.Selected, new { Id = item.Id, Name = "sels", Value = item.Id })
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Arrival)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Dist)
                        </td>

                        @if (item.Pax > 0)
                        {
                            if (item.FirstClass)
                            {
                                <td> @Html.DisplayFor(modelItem => item.Pax) Pax (Business) </td>
                            }
                            else
                            {
                                <td> @Html.DisplayFor(modelItem => item.Pax) Pax (Economy)  </td>
                            }
                        }
                        else
                        {
                            <td> @Html.DisplayFor(modelItem => item.Cargo) Kg (Cargo)  </td>
                        }
                        <td>
                            @Html.DisplayFor(modelItem => item.Pay)
                        </td>
                    </tr>
                }
            </table>
            </div>
            @Html.PagedListPager(Model, pageNumber => Url.Action("Result", new  {   pageNumber  }))
            <hr />
            <div class="form-group" style="text-align:right">
                <div class="col-md-offset-2 col-md-10">
                    <input type="submit" value="Next" class="btn btn-info  pull-right" />
                </div>
            </div>
            }
            else
            {
            <p>
                <h1 style="color:red;">No data found.</h1>
            </p>
            }

            <script type='text/javascript'>
                $(function () {

                    $("ul.pagination li").click(function (e) {

                        var url = $(this).find("a").attr("href");
                        var selectedCheckbox = [];
                        $("input[type='checkbox']").each(function () {
                            if ($(this).prop("checked")) {
                                selectedCheckbox.push($(this).attr("id"));
                            }
                        });
                        $(this).find("a").attr("href", url + '&ids=' + selectedCheckbox);
                        //alert($(this).find("a").attr("href"));
                    });
                });

            </script>




            <div>
                @Html.ActionLink("Back to Search", "Index")
            </div>


            }


